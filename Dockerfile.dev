FROM quantumsheep/godbox-base:latest

RUN set -xe && \
    apt-get update && \
    rm -rf /var/lib/apt/lists/* && \
    curl https://sh.rustup.rs -sSf | sh -s -- -y --default-toolchain=nightly && \
    . $HOME/.cargo/env

RUN ~/.cargo/bin/cargo install cargo-watch

WORKDIR /usr/src/app

COPY src src

COPY Cargo.toml .

ENV ROCKET_ADDRESS=0.0.0.0
ENV ROCKET_PORT=8080

CMD ~/.cargo/bin/cargo watch -x run
